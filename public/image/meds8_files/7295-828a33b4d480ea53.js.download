"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7295],{50415:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(77349),i=n(83946),o=n(19013),a=n(13882);function u(e,t){(0,a.Z)(2,arguments);var n=(0,o.Z)(e),r=(0,i.Z)(t);if(isNaN(r))return new Date(NaN);if(!r)return n;var u=n.getDate(),l=new Date(n.getTime());l.setMonth(n.getMonth()+r+1,0);var c=l.getDate();return u>=c?l:(n.setFullYear(l.getFullYear(),l.getMonth(),u),n)}function l(e,t){if((0,a.Z)(2,arguments),!t||"object"!==typeof t)return new Date(NaN);var n=t.years?(0,i.Z)(t.years):0,l=t.months?(0,i.Z)(t.months):0,c=t.weeks?(0,i.Z)(t.weeks):0,s=t.days?(0,i.Z)(t.days):0,d=t.hours?(0,i.Z)(t.hours):0,f=t.minutes?(0,i.Z)(t.minutes):0,v=t.seconds?(0,i.Z)(t.seconds):0,p=(0,o.Z)(e),m=l||n?u(p,l+12*n):p,h=s||c?(0,r.Z)(m,s+7*c):m,S=f+60*d,g=v+60*S,y=1e3*g,I=new Date(h.getTime()+y);return I}},77349:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(83946),i=n(19013),o=n(13882);function a(e,t){(0,o.Z)(2,arguments);var n=(0,i.Z)(e),a=(0,r.Z)(t);return isNaN(a)?new Date(NaN):a?(n.setDate(n.getDate()+a),n):n}},7295:function(e,t,n){n.d(t,{W:function(){return j},d:function(){return R}});var r=n(34051),i=n.n(r),o=n(85893),a=n(15144),u=n(53685),l=n(84069),c=n(50344),s=n(11124),d=n(22674),f=n(79945),v=n(45578),p=n.n(v),m=n(26961),h=n(67294),S=n(75397),g=n(88528),y=n(94153),I=n(76209),N=n(78457),C=n(50415),P=n(84886),k=n(88865),A=n(5558),b=n(24477),D=n(90868);function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function w(e,t,n,r,i,o,a){try{var u=e[o](a),l=u.value}catch(c){return void n(c)}u.done?t(l):Promise.resolve(l).then(r,i)}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function E(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){O(e,t,n[t])}))}return e}function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,u=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(l){u=!0,i=l}finally{try{a||null==n.return||n.return()}finally{if(u)throw i}}return o}}(e,t)||q(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function U(e){return function(e){if(Array.isArray(e))return F(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||q(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(e,t){if(e){if("string"===typeof e)return F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?F(e,t):void 0}}var x=n.e(9483).then(n.t.bind(n,69483,23)).then((function(e){return e.default})),j=function(e){var t={fileName:"",fileUrl:"",fileType:"",baseFormat:""},n={city:"",pincode:"",state:"",country:"",lat:"",lng:""},r=(0,u.aC)(),v=r.currentPatient,F=r.authToken,O=(0,s.x)(),q=(0,a.j)()&&localStorage.getItem("cartPreferences"),j=(0,h.useState)(""),R=j[0],Z=j[1],L=(0,h.useState)(""),H=L[0],M=L[1],J=(0,h.useState)(""),G=J[0],K=J[1],_=(0,h.useState)(30),V=_[0],B=_[1],Y=T((0,N.i)(null,"buyAgainProductList",{expiredDate:(0,C.Z)(new Date,{days:1})}),2),z=Y[0],X=Y[1],Q=(0,h.useState)(!1),W=Q[0],$=Q[1],ee=(0,h.useState)(!1),te=ee[0],ne=ee[1],re=(0,h.useState)(0),ie=re[0],oe=re[1],ae=(0,h.useState)(!1),ue=ae[0],le=ae[1],ce=(0,h.useState)(!1),se=ce[0],de=ce[1],fe=(0,h.useState)(null),ve=fe[0],pe=fe[1],me=(0,h.useState)(null),he=me[0],Se=me[1],ge=(0,h.useState)(null),ye=ge[0],Ie=ge[1],Ne=(0,h.useState)(!1),Ce=Ne[0],Pe=Ne[1],ke=(0,h.useState)([]),Ae=ke[0],be=ke[1],De=(0,h.useState)(q?JSON.parse((0,m.decompress)(q)):null),Fe=De[0],we=De[1],Oe=(0,h.useState)(null),Ee=Oe[0],Te=Oe[1],Ue=(0,h.useState)([]),qe=Ue[0],xe=Ue[1],je=(0,h.useState)(""),Re=(je[0],je[1]),Ze=(0,h.useState)([]),Le=Ze[0],He=Ze[1],Me=(0,h.useState)([]),Je=Me[0],Ge=Me[1],Ke=T((0,d.D)(f.VU),1)[0],_e=T((0,N.V)([],"prescriptions"),2),Ve=_e[0],Be=_e[1],Ye=(0,h.useState)(t),ze=Ye[0],Xe=Ye[1],Qe=(0,h.useState)((0,a.j)()&&localStorage.getItem("deliveryAddressId")||""),We=Qe[0],$e=Qe[1],et=T((0,N.V)([],"ePrescriptionData"),2),tt=et[0],nt=et[1],rt=(0,h.useState)(!1),it=rt[0],ot=rt[1],at=(0,h.useState)(n),ut=at[0],lt=at[1],ct=(0,h.useState)([]),st=ct[0],dt=ct[1],ft=(0,h.useState)([]),vt=ft[0],pt=ft[1],mt=(0,h.useState)(JSON.stringify(st||{})),ht=mt[0],St=mt[1],gt=(0,h.useState)([]),yt=gt[0],It=gt[1],Nt=(0,h.useState)(""),Ct=Nt[0],Pt=Nt[1],kt=(0,h.useState)(!1),At=kt[0],bt=kt[1],Dt=(0,h.useState)(null),Ft=Dt[0],wt=Dt[1],Ot=(0,h.useState)(""),Et=Ot[0],Tt=Ot[1],Ut=(0,h.useState)("prescription"),qt=Ut[0],xt=Ut[1],jt=(0,h.useState)([S.l.LANDING]),Rt=jt[0],Zt=jt[1],Lt=(0,h.useState)(l.GD.NA),Ht=Lt[0],Mt=Lt[1],Jt=(0,h.useState)(null),Gt=Jt[0],Kt=Jt[1],_t=(0,h.useState)(null),Vt=_t[0],Bt=_t[1],Yt=(0,h.useState)(!1),zt=Yt[0],Xt=Yt[1],Qt=(0,h.useState)(0),Wt=Qt[0],$t=Qt[1],en=(0,h.useState)(0),tn=en[0],nn=en[1],rn=(0,h.useState)(0),on=rn[0],an=rn[1],un=(0,h.useState)(null),ln=un[0],cn=un[1],sn=(0,h.useState)(I.N.NOTSTARTED),dn=sn[0],fn=sn[1],vn=(0,h.useState)(P.l.NOTSTARTED),pn=vn[0],mn=vn[1],hn=(0,h.useState)(!1),Sn=hn[0],gn=hn[1],yn=ue?0:v&&Vt?parseFloat((Vt.cartTotal-Vt.cartSavings||0).toFixed(2)):parseFloat(st.reduce((function(e,t){return 1===t.couponFree&&t.quantity>1?e+t.quantity*(Number(t.special_price)||t.price)-t.price:0===t.special_price&&1===t.couponFree&&1==t.quantity?e+t.quantity*t.special_price:e+t.quantity*(Number(t.special_price)||t.price)}),0).toFixed(2)),In=function(){var e=(0,a.j)()&&localStorage.getItem("pharmaCoupon");(null===e||void 0===e?void 0:e.length)&&(0,a.j)()&&localStorage.removeItem("pharmaCoupon"),(null===G||void 0===G?void 0:G.length)&&K("")},Nn=function(){if((0,a.j)()){var e;Re(window.location.pathname);var t=localStorage.getItem("cartPreferences"),r=null;r=(null===v||void 0===v||null===(e=v.id)||void 0===e?void 0:e.length)?localStorage.getItem("".concat(v.id)):localStorage.getItem("cartItems"),K(localStorage.getItem("pharmaCoupon"));var i=localStorage.getItem("pharmaAddressDetails")?JSON.parse(localStorage.getItem("pharmaAddressDetails")):n;lt(i),M((null===i||void 0===i?void 0:i.city)||""),we(t?JSON.parse((0,m.decompress)(t)):null),dt(r?JSON.parse(r):[])}},Cn=function(){var e=null===Fe||void 0===Fe?void 0:Fe.checkpoints;((null===e||void 0===e?void 0:e.length)&&e[e.length-1]||S.l.LANDING)!==S.l.LANDING&&we(E({},Fe,{checkpoints:[S.l.LANDING],prescriptionFlowSelected:l.GD.NA}))},Pn=(0,h.useCallback)((function(e){var t=(null===v||void 0===v?void 0:v.id)||"";return Promise.all(e.filter((function(e){var t=e.fileUrl;return!Je.filter((function(e){return e.fileUrl})).map((function(e){return e.fileUrl})).includes(t)})).map((function(e){var n,r=e.baseFormat,i=e.fileType,o=null===(n=null===r||void 0===r?void 0:r.split(";base64,"))||void 0===n?void 0:n[1];return Ke({fetchPolicy:"no-cache",variables:{UploadDocumentInput:{base64FileInput:o,category:l.rs.HealthChecks,fileType:"jpg"==i?l.vq.JPEG:"png"==i?l.vq.PNG:"pdf"==i?l.vq.PDF:l.vq.JPEG,patientId:t}}}).catch((function(e){throw e}))}))).catch((function(e){return console.error(e,"Uploading Prescriptions Failed"),Promise.reject([])}))}),[Je,v]),kn=(0,h.useCallback)(function(){var e,t=(e=i().mark((function e(t,n){var r,o,a,u,l,s,d,f,p,m,h,S=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=S.length>2&&void 0!==S[2]?S[2]:{},o=(null===v||void 0===v?void 0:v.id)||"",!(null===t||void 0===t?void 0:t.length)&&!(null===n||void 0===n?void 0:n.length)||!o){e.next=14;break}return u=[],e.next=7,Pn(t);case 7:(null===(l=e.sent)||void 0===l?void 0:l.length)&&(s=l.filter((function(e){var t,n;return null===e||void 0===e||null===(t=e.data)||void 0===t||null===(n=t.uploadDocument)||void 0===n?void 0:n.status})).map((function(e){var t;return null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.uploadDocument})),d=(null===l||void 0===l?void 0:l.length)===(null===s||void 0===s?void 0:s.length),f=s.map((function(e,n){var r,i,o,a=e.fileId,u=e.filePath;return{prismFileId:a||"",appointmentId:"",fileUrl:d&&(null===t||void 0===t||null===(r=t[n])||void 0===r?void 0:r.fileUrl)||u||"",date:"",doctorName:"",medicineNames:[],medicineSku:[],forPatient:(null===v||void 0===v?void 0:v.firstName)||"",fileName:d&&(null===t||void 0===t||null===(i=t[n])||void 0===i?void 0:i.fileName)||"",fileType:d&&(null===t||void 0===t||null===(o=t[n])||void 0===o?void 0:o.fileType)||""}})),u=u.concat(f),d||Pt(c.u.PrescriptionUploadFailed)),(null===n||void 0===n?void 0:n.length)&&(p=n.filter((function(e){var t=e.prismFileId;return!Je.filter((function(e){return e.prismFileId})).map((function(e){return e.prismFileId})).includes(t)})).map((function(e){return{prismFileId:e.prismFileId||"",fileUrl:e.fileUrl,appointmentId:e.appointmentId,date:e.date,doctorName:e.doctorName,forPatient:e.forPatient,medicineNames:e.medicineNames,medicineSku:e.medicineSku,fileName:"",fileType:""}})),u=u.concat(p)),m=[],(null===u||void 0===u?void 0:u.length)&&(m=u.map((function(e){return{fileUrl:(null===e||void 0===e?void 0:e.fileUrl)||"",prismFileId:(null===e||void 0===e?void 0:e.prismFileId)||"",appointmentId:(null===e||void 0===e?void 0:e.appointmentId)||"",uhid:(null===v||void 0===v?void 0:v.uhid)||"",meta:{createdAt:(null===e||void 0===e?void 0:e.date)||(new Date).toDateString(),doctorName:(null===e||void 0===e?void 0:e.doctorName)||"",fileName:(null===e||void 0===e?void 0:e.fileName)||"",fileType:(null===e||void 0===e?void 0:e.fileType)||"",medicineNames:(null===e||void 0===e?void 0:e.medicineNames)||[],medicineSku:(null===e||void 0===e?void 0:e.medicineSku)||[],patientName:(null===e||void 0===e?void 0:e.forPatient)||""}}}))),h=E({},r,(null===m||void 0===m?void 0:m.length)&&{prescriptionDetails:m}),(null===(a=Object.keys(h))||void 0===a?void 0:a.length)&&Se(h);case 14:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){w(o,r,i,a,u,"next",e)}function u(e){w(o,r,i,a,u,"throw",e)}a(void 0)}))});return function(e,n){return t.apply(this,arguments)}}(),[v,Je]),An=function(e){ue?Bt({estimatedAmount:0,estimatedAmountPreCoupon:0,deliveryCharges:0,isDeliveryFree:!0,freeDeliveryAmount:0,cartSavings:0,couponSavings:0,totalCashBack:0,cartTotal:0,circleSavings:null,couponCashBack:0}):e&&Bt(e)};return(0,h.useEffect)((function(){An()}),[ue]),(0,h.useEffect)((function(){var e,n,r=(null===v||void 0===v?void 0:v.id)||"";if((null===ze||void 0===ze||null===(e=ze.fileName)||void 0===e?void 0:e.length)&&!r&&Ve){var i=U(Ve).concat([ze]);Be&&Be(i),Xe(t)}if(tt&&it&&!r&&(x.then((function(e){return e.setItem("ePrescriptionData",tt,(function(e){e&&(0,D.Z)("ePrescriptionData","localForage","write",e)}))})),ot(!1)),r&&((null===ze||void 0===ze||null===(n=ze.fileName)||void 0===n?void 0:n.length)||it)){var o=[ze].filter((function(e){var t=e.baseFormat,n=e.fileUrl;return t&&n})),a=tt.filter((function(e){return e.fileUrl}));kn(o,a),Xe(t),ot(!1)}}),[ze,tt,it,v]),(0,h.useEffect)((function(){Fe&&localStorage.setItem("cartPreferences",(0,m.compress)(JSON.stringify(Fe)))}),[Fe]),(0,h.useEffect)((function(){Nn()}),[]),(0,h.useEffect)((function(){if(W){var e=JSON.stringify(st);(null===v||void 0===v?void 0:v.id)?(localStorage.setItem("".concat(v.id),e),localStorage.removeItem("cartItems")):localStorage.setItem("cartItems",e),st.length||In(),St(e),$(!1)}}),[st,W]),(0,h.useEffect)((function(){if(G){var e=localStorage.getItem("pharmaCoupon");G.length&&G!==e?localStorage.setItem("pharmaCoupon",G):G.length||In()}}),[G]),(0,h.useEffect)((function(){(null===ut||void 0===ut?void 0:ut.pincode)&&localStorage.setItem("pharmaPincode",ut.pincode)}),[ut]),(0,h.useEffect)((function(){var e;if((null===v||void 0===v||null===(e=v.id)||void 0===e?void 0:e.length)>0){var t=localStorage.getItem("".concat(v.id));dt(t?JSON.parse(t):[])}}),[v]),(0,h.useEffect)((function(){localStorage.setItem("deliveryAddressId",We)}),[We]),(0,h.useEffect)((function(){var e=[];yt.forEach((function(t){st.map((function(e){return e.sku})).includes(t)||e.push(t)})),localStorage.setItem("removedSkuList",e.join(","))}),[yt,st]),(0,h.useEffect)((function(){(null===v||void 0===v?void 0:v.id)&&O.query({query:A.tY,variables:{patientId:v.id},fetchPolicy:"no-cache"}).then((function(e){var t,n,r,i,o;(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.getOneApolloUser)&&(an(null===e||void 0===e||null===(n=e.data)||void 0===n||null===(r=n.getOneApolloUser)||void 0===r?void 0:r.availableHC),nn(null===e||void 0===e||null===(i=e.data)||void 0===i||null===(o=i.getOneApolloUser)||void 0===o?void 0:o.availableHC))})).catch((function(e){console.error(k.yv.apolloHcsError,e),an(0),nn(0)}))}),[null===v||void 0===v?void 0:v.id]),(0,h.useEffect)((function(){if(Vt){var e=Vt.estimatedAmount;zt&&(e>=tn?(an(0),$t(tn)):(an(tn-e),$t(e)))}}),[tn,null===Vt||void 0===Vt?void 0:Vt.estimatedAmount]),(0,o.jsx)(g.Ew.Provider,{value:{isHCPreferred:zt,medicineOrderAddressDetails:ln,setMedicineOrderAddressDetails:cn,fetchCartPollsLeft:ie,setFetchCartPollsLeft:oe,callRenewCart:te,setCallRenewCart:ne,fetchingCart:dn,setFetchingCart:fn,updatingCart:pn,setUpdatingCart:mn,whatsAppReminderSettings:ve,cartShipments:Le,validCouponResponse:ye,serverCartErrorMessage:Ct,userActionPayload:he,nonCartFlow:ue,showSearchPdp:se,setShowSearchPdp:de,serverPrescriptions:Je,cartAmountBreakup:Vt,usedHC:Wt,cartTotal:yn,cartItems:st,outOfStockItems:vt,itemsStr:ht,prescriptions:Ve,deliveryAddresses:Ae,deliveryAddressId:We,prescriptionUploaded:ze,ePrescriptionData:tt,updatedEPrescription:it,durationDays:V,couponCode:G,medicineAddress:H,storePickupPincode:Ee,stores:qe,storeAddressId:R,prescriptionOptionSelected:Ft,prescriptionDuration:qt,customerCartPreferences:Fe,isEPrescriptionOpen:Ce,cartFlowCheckpoints:Rt,prescriptionFlowSelected:Ht,patientSelectedForConsult:Gt,prescriptionCustomerComment:Et,showCouponSuccessApplied:At,totalHCAvailable:tn,availableHC:on,updateEprescriptions:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=p()(U(e),(function(e){return(null===e||void 0===e?void 0:e.prismFileId)||(null===e||void 0===e?void 0:e.fileUrl)})),r=p()(U(t),(function(e){return(null===e||void 0===e?void 0:e.prismFileId)||(null===e||void 0===e?void 0:e.fileUrl)}));if(null===v||void 0===v?void 0:v.id){var i,o=[],a=n.filter((function(e){var t=e.prismFileId;return!Je.filter((function(e){return e.prismFileId})).map((function(e){return e.prismFileId})).includes(t)})).map((function(e){return{prismFileId:e.prismFileId||"",fileUrl:e.fileUrl,appointmentId:e.appointmentId,date:e.date,doctorName:e.doctorName,forPatient:e.forPatient,medicineNames:e.medicineNames,medicineSku:e.medicineSku,fileName:"",fileType:""}})),u=[];(null===(o=o.concat(a))||void 0===o?void 0:o.length)&&(u=o.map((function(e){return{fileUrl:(null===e||void 0===e?void 0:e.fileUrl)||"",prismFileId:(null===e||void 0===e?void 0:e.prismFileId)||"",appointmentId:(null===e||void 0===e?void 0:e.appointmentId)||"",uhid:(null===v||void 0===v?void 0:v.uhid)||"",meta:{createdAt:(null===e||void 0===e?void 0:e.date)||(new Date).toDateString(),doctorName:(null===e||void 0===e?void 0:e.doctorName)||"",fileName:(null===e||void 0===e?void 0:e.fileName)||"",fileType:(null===e||void 0===e?void 0:e.fileType)||"",medicineNames:(null===e||void 0===e?void 0:e.medicineNames)||[],medicineSku:(null===e||void 0===e?void 0:e.medicineSku)||[],patientName:(null===e||void 0===e?void 0:e.forPatient)||""}}})));var l=E({},(null===(u=u.concat(r.map((function(e){return{fileUrl:"",prismFileId:e.prismFileId}}))))||void 0===u?void 0:u.length)&&{prescriptionDetails:u});(null===(i=Object.keys(l))||void 0===i?void 0:i.length)&&Se(l)}else{var c=p()(U(tt).concat(U(n)),(function(e){return(null===e||void 0===e?void 0:e.prismFileId)||(null===e||void 0===e?void 0:e.fileUrl)}));r.forEach((function(e){c=c.filter((function(t){return(null===t||void 0===t?void 0:t.prismFileId)===(null===e||void 0===e?void 0:e.prismFileId)||(null===t||void 0===t?void 0:t.fileUrl)===(null===e||void 0===e?void 0:e.fileUrl)}))})),nt(c),ot(!0)}},setCartItems:dt,addCartItem:function(e,t){if((0,b.Kc)(F,e.sku),null===v||void 0===v?void 0:v.id)Se({medicineOrderCartLineItems:[{medicineSKU:e.sku,quantity:e.quantity}]});else if(null===ut||void 0===ut?void 0:ut.pincode)(0,y.f5)([{sku:null===e||void 0===e?void 0:e.sku,qty:1}],null===ut||void 0===ut?void 0:ut.pincode,ut.lat,ut.lng).then((function(t){var n,r,i,o,a,u,l,c;if((null===t||void 0===t||null===(n=t.response)||void 0===n||null===(r=n[0])||void 0===r||null===(i=r.items)||void 0===i||null===(o=i[0])||void 0===o?void 0:o.exist)||vt.includes(null===e||void 0===e?void 0:e.sku)){if(null===t||void 0===t||null===(a=t.response)||void 0===a||null===(u=a[0])||void 0===u||null===(l=u.items)||void 0===l||null===(c=l[0])||void 0===c?void 0:c.exist){var s=U(st).concat([e]),d=s.filter((function(e){return e.couponFree})),f=s.filter((function(e){return!e.couponFree}));dt(f.concat(d)),$(!0),vt.includes(null===e||void 0===e?void 0:e.sku)&&pt(U(vt.splice(vt.indexOf(e.sku),1)))}}else pt(U(vt).concat([null===e||void 0===e?void 0:e.sku]))})).catch((function(e){console.error(e,"Product is Not Available to add")}));else{var n=U(st).concat([e]),r=n.filter((function(e){return e.couponFree})),i=n.filter((function(e){return!e.couponFree}));dt(i.concat(r)),$(!0)}Cn()},clearCartInfo:function(){Z(""),xe([]),be([]),Te(""),Be([]),nt([])},pharmaAddressDetails:ut,addCartItems:function(e){if(e&&Array.isArray(e)&&e.length){if(null===v||void 0===v?void 0:v.id)Se({medicineOrderCartLineItems:e.map((function(e){return{medicineSKU:e.sku,quantity:e.quantity}}))});else{var t=U(st).concat(e),n=t.filter((function(e){return e.couponFree})),r=t.filter((function(e){return!e.couponFree}));dt(r.concat(n)),$(!0)}Cn()}},buyAgainProductList:z,hideCouponDialog:Sn,setHideCouponDialog:gn,setBuyAgainProductList:X,replaceCartItems:function(e){if(e){var t=U(e),n=t.filter((function(e){return e.couponFree})),r=t.filter((function(e){return!e.couponFree}));dt(r.concat(n)),$(!0)}},removeCartItemSku:function(e){if(null===v||void 0===v?void 0:v.id)Se({medicineOrderCartLineItems:[{medicineSKU:e,quantity:0}]});else{yt.includes(e)||It(U(yt).concat([e]));var t=st.filter((function(t){return t.sku!==e})),n=t.filter((function(e){return e.couponFree})),r=t.filter((function(e){return!e.couponFree}));dt(r.concat(n)),$(!0)}Cn()},removeCartItems:function(e){if(null===v||void 0===v?void 0:v.id)Se({medicineOrderCartLineItems:e.map((function(e){return{medicineSKU:e,quantity:0}}))});else{var t=U(yt);e.forEach((function(e){t.includes(e)||t.push(e)})),t.length>yt.length&&It(t);var n=st.filter((function(t){return!e.includes(t.sku)}));n.length<st.length&&(dt(n),$(!0))}Cn()},updateCartItem:function(e){var t=st.findIndex((function(t){return t.sku==e.sku}));if(t>=0){if(st&&e&&e.quantity){var n=st[t].quantity+e.quantity;(null===v||void 0===v?void 0:v.id)?Se({medicineOrderCartLineItems:[{medicineSKU:st[t].sku,quantity:n}]}):(st[t].quantity=n,dt(U(st)),$(!0))}Cn()}},updateCartItemQty:function(e){var t=st.findIndex((function(t){return t.sku==e.sku}));if(t>=0){if(st&&e){var n=e.quantity;(null===v||void 0===v?void 0:v.id)?Se({medicineOrderCartLineItems:[{medicineSKU:st[t].sku,quantity:n}]}):(st[t].quantity=n,st[t].couponFree=st[t].couponFree||e.couponFree||0,dt(U(st)),$(!0))}Cn()}},addMultipleCartItems:function(e){var t=st;if(null===v||void 0===v?void 0:v.id)Se({medicineOrderCartLineItems:e.map((function(e){var n=t.findIndex((function(t){return t.sku===e.sku}));return{medicineSKU:e.sku,quantity:n>=0?t[n].quantity+e.quantity:e.quantity}}))});else{var n=st;e.forEach((function(e){var r=t.findIndex((function(t){return t.sku===e.sku}));r>=0?n[r].quantity=n[r].quantity+e.quantity:n.push(e)})),dt(n),$(!0)}Cn()},setStorePickupPincode:Te,setStores:xe,setDurationDays:B,setDeliveryAddressId:$e,setDeliveryAddresses:be,setPrescriptions:Be,setPrescriptionUploaded:Xe,setEPrescriptionData:nt,setPharmaAddressDetails:lt,setMedicineAddress:M,setStoreAddressId:Z,setUpdatedEPrescription:ot,setCouponCode:K,setPrescriptionOptionSelected:wt,setPrescriptionDuration:xt,syncCartContext:Nn,setCustomerCartPreferences:we,setIsEPrescriptionOpen:Pe,setCartFlowCheckpoints:Zt,setPrescriptionFlowSelected:Mt,setPatientSelectedForConsult:Kt,setPrescriptionCustomerComment:Tt,setServerPrescriptions:Ge,updatePrescriptionFilesForOrders:kn,updateCartAmountBreakup:An,setRemovedSKUs:It,setNonCartFlow:le,setUserActionPayload:Se,setServerCartErrorMessage:Pt,setValidCouponResponse:Ie,setCartShipments:He,setCartCheckPointLanding:Cn,setShowCouponSuccessApplied:bt,setUsedHC:$t,setTotalHCAvailable:nn,setAvailableHC:an,setWhatsAppReminderSettings:pe,setIsHCPreferred:Xt,setOutOfStockItems:pt},children:e.children})},R=function(){return(0,h.useContext)(g.Ew)}},76209:function(e,t,n){var r;n.d(t,{N:function(){return r}}),function(e){e.STARTED="STARTED",e.RUNNING="RUNNING",e.ENDED="ENDED",e.NOTSTARTED="NOTSTARTED"}(r||(r={}))},84886:function(e,t,n){var r;n.d(t,{l:function(){return r}}),function(e){e.STARTED="STARTED",e.RUNNING="RUNNING",e.ENDED="ENDED",e.NOTSTARTED="NOTSTARTED"}(r||(r={}))},50344:function(e,t,n){var r;n.d(t,{u:function(){return r}}),function(e){e.addItems="Please add items to cart. Net Amount should be above minimum order value",e.chooseAddress="Please choose delivery address",e.prescriptionNeeded="Prescription is required",e.hasNotForSaleItems="Some cart items are not for sale",e.NonServiceableItemsCart="Please remove items from cart that are not deliverable",e.PatientNotSelected="Please select a patient for doctor consulation",e.AddressNotServicable="Selected address not servicable, please update address and continue again",e.CouponValidationFailed="Coupon not applicable on your cart item(s) or item(s) with already higher discounts",e.PrescriptionUploadFailed="Prescription Upload Failed. Please try again later or choose a different option",e.EmptyShipments="Your shipments are found to be empty. Please try again later or refresh the page"}(r||(r={}))},24477:function(e,t,n){n.d(t,{Jp:function(){return v},Iw:function(){return p},Kc:function(){return m}});var r=n(34051),i=n.n(r),o=n(9669),a=n.n(o),u=n(15144),l=n(88385);function c(e,t,n,r,i,o,a){try{var u=e[o](a),l=u.value}catch(c){return void n(c)}u.done?t(l):Promise.resolve(l).then(r,i)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){c(o,r,i,a,u,"next",e)}function u(e){c(o,r,i,a,u,"throw",e)}a(void 0)}))}}var d={authToken:l.Hx,hitUrl:"".concat(l.O3,"/hit"),initTurretSrchURL:"".concat(l.O3,"/init"),turretAddToCart:"".concat(l.O3,"/addToCart")},f=function(){var e=s(i().mark((function e(t,n,r){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",a().get("".concat(d.hitUrl),{headers:{Authorization:d.authToken,"X-TOKEN":t},params:{query:n,param:r}}).catch((function(e){console.error("Search Hit Api failed",e)})));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),v=function(e,t,n){(0,u.j)()&&f(e,t,n)},p=function(){var e=s(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,u.j)()){e.next=9;break}return e.prev=1,e.next=4,a().get("".concat(d.initTurretSrchURL),{headers:{Authorization:d.authToken,"X-TOKEN":t}});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.error("There was an error initialising turret search",e.t0);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=s(i().mark((function e(t,n){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,u.j)()){e.next=9;break}return e.prev=1,e.next=4,a().get("".concat(d.turretAddToCart),{headers:{Authorization:d.authToken,"X-TOKEN":t},params:{sku:n}});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),console.error("There was an error tracking add to cart turret event",e.t0);case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t,n){return e.apply(this,arguments)}}()},90868:function(e,t){t.Z=function(e,t,n,r){console.log("Error performing ".concat(n," in ").concat(t," at key - "),e,r)}},78457:function(e,t,n){n.d(t,{V:function(){return c},i:function(){return s}});var r=n(19013),i=n(13882);function o(e){return(0,i.Z)(1,arguments),(0,r.Z)(e).getTime()<Date.now()}var a=n(67294),u=n(90868),l=n.e(9483).then(n.t.bind(n,69483,23)).then((function(e){return e.default}));function c(e,t){var n=(0,a.useState)(e),r=n[0],i=n[1];return(0,a.useEffect)((function(){l.then((function(n){return n.getItem(t,(function(n,r){if(n)return(0,u.Z)(t,"localForage","read",n),void i(e);i(r||e)}))}))}),[]),(0,a.useEffect)((function(){var e;e=r,l.then((function(n){return n.setItem(t,e,(function(e){e&&(0,u.Z)(t,"localForage","write",e)}))}))}),[r]),[r,i]}function s(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=function(){try{var n=localStorage.getItem(t);if(n){var r=JSON.parse(n),i=r.state,a=r.cacheOptions;if(null===a||void 0===a?void 0:a.expiredDate)if(o(new Date(a.expiredDate)))return e;return i}return e}catch(u){return e}},i=(0,a.useState)((function(){return r()})),u=i[0],l=i[1];(0,a.useEffect)((function(){!function(e){try{var r=function(e){try{var r=localStorage.getItem(t);if(r){var i=JSON.parse(r).cacheOptions;if((null===i||void 0===i?void 0:i.expiredDate)&&!o(new Date(i.expiredDate)))return{state:e,cacheOptions:i}}return{state:e,cacheOptions:n}}catch(a){return}}(e),i=r.state,a=r.cacheOptions;localStorage.setItem(t,JSON.stringify({state:i,cacheOptions:a}))}catch(u){return}}(u)}),[u]);var c=[u,l];return c}},22674:function(e,t,n){n.d(t,{D:function(){return s}});var r=n(69935),i=n(67294),o=n(11124),a=n(26554),u=n(4486);function l(){return l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(this,arguments)}var c=function(){return{called:!1,data:void 0,error:void 0,hasError:!1,loading:!1}};function s(e,t){void 0===t&&(t={});var n=(0,o.x)(t.client),s=i.useState(c),d=s[0],f=s[1],v=t,p=v.rethrow,m=void 0===p||p,h=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(v,["rethrow"]),S=function(e){(0,a.Z)((function(){f((function(t){return l({},t,{},e)}))}))};i.useEffect((function(){S({called:!1,data:void 0,error:void 0,hasError:!1,loading:!1})}),[n]);var g=function(){var e=i.useRef(0);return{generateNewMutationId:function(){return e.current+=1,e.current},isMostRecentMutation:function(t){return e.current===t}}}(),y=g.generateNewMutationId,I=g.isMostRecentMutation,N=function(e,t){I(t)&&S({error:e,hasError:!0,loading:!1})};return[i.useCallback((function(t){return void 0===t&&(t={}),new Promise((function(i,o){d.loading||S({called:!0,data:void 0,error:void 0,hasError:!1,loading:!0});var a=y(),u=h.variables?l({},t.variables,{},h.variables):t.variables;n.mutate(l({mutation:e},h,{},t,{variables:u})).then((function(e){!function(e,t){var n=e.data,i=e.errors;i&&i.length>0?N(new r.cA({graphQLErrors:i}),t):I(t)&&S({data:n,loading:!1})}(e,a),i(e)})).catch((function(e){N(e,a),m?o(e):i({})}))}))}),[n,e,(0,u.pq)(t)]),d]}}}]);